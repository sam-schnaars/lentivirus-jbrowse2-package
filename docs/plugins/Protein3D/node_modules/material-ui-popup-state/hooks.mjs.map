{"version":3,"file":"hooks.mjs","names":["useCallback","useState","useRef","useEffect","React","useEvent","printedWarnings","warn","key","message","console","error","initCoreState","isOpen","setAnchorElUsed","anchorEl","undefined","anchorPosition","hovered","focused","_openEventType","_childPopupState","_deferNextOpen","_deferNextClose","_react","defaultPopupId","useId","usePopupState","parentPopupState","popupId","variant","disableAutoFocus","isMounted","current","state","_setState","setState","setAnchorEl","toggle","eventOrAnchorEl","close","open","event","Element","element","currentTarget","type","clientX","clientY","left","top","doOpen","setTimeout","_setChildPopupState","popupState","newState","doClose","setOpen","nextOpen","onMouseLeave","relatedTarget","isElementInPopup","onBlur","Boolean","anchorRef","controlAriaProps","bindTrigger","onClick","onTouchStart","bindContextMenu","onContextMenu","e","preventDefault","bindToggle","bindHover","onMouseOver","bindFocus","onFocus","bindDoubleClick","onDoubleClick","bindPopover","usePopoverPosition","id","anchorReference","onClose","disableEnforceFocus","disableRestoreFocus","bindMenu","autoFocus","disableAutoFocusItem","bindPopper","bindDialog","getPopup","rootNode","getRootNode","document","getElementById","isAncestor","parent","child","parentElement"],"sources":["src/hooks.ts"],"sourcesContent":["/* eslint-env browser */\n\nimport {\n  type SyntheticEvent,\n  type MouseEvent,\n  type TouchEvent,\n  type FocusEvent,\n  useCallback,\n  useState,\n  useRef,\n  useEffect,\n} from 'react'\nimport * as React from 'react'\nimport { type PopoverPosition, type PopoverReference } from '@mui/material'\nimport { useEvent } from './useEvent'\n\nconst printedWarnings: Record<string, boolean> = {}\n\nfunction warn(key: string, message: string) {\n  if (printedWarnings[key]) return\n  printedWarnings[key] = true\n  console.error('[material-ui-popup-state] WARNING', message) // eslint-disable-line no-console\n}\n\nexport type Variant = 'popover' | 'popper' | 'dialog'\n\nexport type PopupState = {\n  open: (eventOrAnchorEl?: SyntheticEvent | Element | null) => void\n  close: (eventOrAnchorEl?: SyntheticEvent | Element | null) => void\n  toggle: (eventOrAnchorEl?: SyntheticEvent | Element | null) => void\n  onBlur: (event: FocusEvent) => void\n  onMouseLeave: (event: MouseEvent) => void\n  setOpen: (\n    open: boolean,\n    eventOrAnchorEl?: SyntheticEvent | Element | null\n  ) => void\n  isOpen: boolean\n  anchorEl: Element | undefined\n  anchorPosition: PopoverPosition | undefined\n  setAnchorEl: (anchorEl: Element | null | undefined) => any\n  setAnchorElUsed: boolean\n  disableAutoFocus: boolean\n  popupId: string | undefined\n  variant: Variant\n  _openEventType: string | null | undefined\n  _childPopupState: PopupState | null | undefined\n  _setChildPopupState: (popupState: PopupState | null | undefined) => void\n}\n\nexport type CoreState = {\n  isOpen: boolean\n  setAnchorElUsed: boolean\n  anchorEl: Element | undefined\n  anchorPosition: PopoverPosition | undefined\n  hovered: boolean\n  focused: boolean\n  _openEventType: string | null | undefined\n  _childPopupState: PopupState | null | undefined\n  _deferNextOpen: boolean\n  _deferNextClose: boolean\n}\n\nexport const initCoreState: CoreState = {\n  isOpen: false,\n  setAnchorElUsed: false,\n  anchorEl: undefined,\n  anchorPosition: undefined,\n  hovered: false,\n  focused: false,\n  _openEventType: null,\n  _childPopupState: null,\n  _deferNextOpen: false,\n  _deferNextClose: false,\n}\n\n// https://github.com/jcoreio/material-ui-popup-state/issues/138\n// Webpack prod build doesn't like it if we refer to React.useId conditionally,\n// but aliasing to a variable like this works\nconst _react = React\nconst defaultPopupId =\n  'useId' in _react\n    ? () => _react.useId()\n    : // istanbul ignore next\n      () => undefined\n\nexport function usePopupState({\n  parentPopupState,\n  popupId = defaultPopupId(),\n  variant,\n  disableAutoFocus,\n}: {\n  parentPopupState?: PopupState | null | undefined\n  popupId?: string | null\n  variant: Variant\n  disableAutoFocus?: boolean | null | undefined\n}): PopupState {\n  const isMounted = useRef(true)\n\n  useEffect((): (() => void) => {\n    isMounted.current = true\n    return () => {\n      isMounted.current = false\n    }\n  }, [])\n\n  const [state, _setState] = useState(initCoreState)\n\n  const setState = useCallback(\n    (state: CoreState | ((prevState: CoreState) => CoreState)) => {\n      if (isMounted.current) _setState(state)\n    },\n    []\n  )\n\n  const setAnchorEl = useCallback(\n    (anchorEl: Element | null | undefined) =>\n      setState((state) => ({\n        ...state,\n        setAnchorElUsed: true,\n        anchorEl: anchorEl ?? undefined,\n      })),\n    []\n  )\n\n  const toggle = useEvent(\n    (eventOrAnchorEl?: SyntheticEvent | Element | null) => {\n      if (state.isOpen) close(eventOrAnchorEl)\n      else open(eventOrAnchorEl)\n      return state\n    }\n  )\n\n  const open = useEvent((eventOrAnchorEl?: SyntheticEvent | Element | null) => {\n    const event =\n      eventOrAnchorEl instanceof Element ? undefined : eventOrAnchorEl\n    const element =\n      eventOrAnchorEl instanceof Element\n        ? eventOrAnchorEl\n        : eventOrAnchorEl?.currentTarget instanceof Element\n        ? eventOrAnchorEl.currentTarget\n        : undefined\n\n    if (event?.type === 'touchstart') {\n      setState((state) => ({ ...state, _deferNextOpen: true }))\n      return\n    }\n\n    const clientX = (event as MouseEvent | undefined)?.clientX\n    const clientY = (event as MouseEvent | undefined)?.clientY\n    const anchorPosition =\n      typeof clientX === 'number' && typeof clientY === 'number'\n        ? { left: clientX, top: clientY }\n        : undefined\n\n    const doOpen = (state: CoreState): CoreState => {\n      if (!eventOrAnchorEl && !state.setAnchorElUsed && variant !== 'dialog') {\n        warn(\n          'missingEventOrAnchorEl',\n          'eventOrAnchorEl should be defined if setAnchorEl is not used'\n        )\n      }\n\n      if (parentPopupState) {\n        if (!parentPopupState.isOpen) return state\n        setTimeout(() => parentPopupState._setChildPopupState(popupState))\n      }\n\n      const newState: CoreState = {\n        ...state,\n        isOpen: true,\n        anchorPosition,\n        hovered: event?.type === 'mouseover' || state.hovered,\n        focused: event?.type === 'focus' || state.focused,\n        _openEventType: event?.type,\n      }\n\n      if (!state.setAnchorElUsed) {\n        if (event?.currentTarget) {\n          newState.anchorEl = event?.currentTarget as any\n        } else if (element) {\n          newState.anchorEl = element\n        }\n      }\n\n      return newState\n    }\n\n    setState((state: CoreState): CoreState => {\n      if (state._deferNextOpen) {\n        setTimeout(() => setState(doOpen), 0)\n        return { ...state, _deferNextOpen: false }\n      } else {\n        return doOpen(state)\n      }\n    })\n  })\n\n  const doClose = (state: CoreState): CoreState => {\n    const { _childPopupState } = state\n    setTimeout(() => {\n      _childPopupState?.close()\n      parentPopupState?._setChildPopupState(null)\n    })\n    return { ...state, isOpen: false, hovered: false, focused: false }\n  }\n\n  const close = useEvent(\n    (eventOrAnchorEl?: SyntheticEvent | Element | null) => {\n      const event =\n        eventOrAnchorEl instanceof Element ? undefined : eventOrAnchorEl\n\n      if (event?.type === 'touchstart') {\n        setState((state) => ({ ...state, _deferNextClose: true }))\n        return\n      }\n\n      setState((state: CoreState): CoreState => {\n        if (state._deferNextClose) {\n          setTimeout(() => setState(doClose), 0)\n          return { ...state, _deferNextClose: false }\n        } else {\n          return doClose(state)\n        }\n      })\n    }\n  )\n\n  const setOpen = useCallback(\n    (\n      nextOpen: boolean,\n      eventOrAnchorEl?: SyntheticEvent<any> | Element | null\n    ) => {\n      if (nextOpen) {\n        open(eventOrAnchorEl)\n      } else {\n        close(eventOrAnchorEl)\n      }\n    },\n    []\n  )\n\n  const onMouseLeave = useEvent((event: MouseEvent) => {\n    const { relatedTarget } = event\n    setState((state: CoreState): CoreState => {\n      if (\n        state.hovered &&\n        !(\n          relatedTarget instanceof Element &&\n          isElementInPopup(relatedTarget, popupState)\n        )\n      ) {\n        if (state.focused) {\n          return { ...state, hovered: false }\n        } else {\n          return doClose(state)\n        }\n      }\n      return state\n    })\n  })\n\n  const onBlur = useEvent((event: FocusEvent) => {\n    if (!event) return\n    const { relatedTarget } = event\n    setState((state: CoreState): CoreState => {\n      if (\n        state.focused &&\n        !(\n          relatedTarget instanceof Element &&\n          isElementInPopup(relatedTarget, popupState)\n        )\n      ) {\n        if (state.hovered) {\n          return { ...state, focused: false }\n        } else {\n          return doClose(state)\n        }\n      }\n      return state\n    })\n  })\n\n  const _setChildPopupState = useCallback(\n    (_childPopupState: PopupState | null | undefined) =>\n      setState((state) => ({ ...state, _childPopupState })),\n    []\n  )\n\n  const popupState: PopupState = {\n    ...state,\n    setAnchorEl,\n    popupId: popupId ?? undefined,\n    variant,\n    open,\n    close,\n    toggle,\n    setOpen,\n    onBlur,\n    onMouseLeave,\n    disableAutoFocus:\n      disableAutoFocus ?? Boolean(state.hovered || state.focused),\n    _setChildPopupState,\n  }\n\n  return popupState\n}\n\n/**\n * Creates a ref that sets the anchorEl for the popup.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function anchorRef({\n  setAnchorEl,\n}: PopupState): (el: Element | null | null | undefined) => any {\n  return setAnchorEl\n}\n\ntype ControlAriaProps = {\n  'aria-controls'?: string\n  'aria-describedby'?: string\n  'aria-haspopup'?: true\n}\n\nfunction controlAriaProps({\n  isOpen,\n  popupId,\n  variant,\n}: PopupState): ControlAriaProps {\n  return {\n    ...(variant === 'popover'\n      ? {\n          'aria-haspopup': true,\n          'aria-controls': isOpen ? popupId : undefined,\n        }\n      : variant === 'popper'\n      ? { 'aria-describedby': isOpen ? popupId : undefined }\n      : undefined),\n  }\n}\n\n/**\n * Creates props for a component that opens the popup when clicked.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindTrigger(popupState: PopupState): ControlAriaProps & {\n  onClick: (event: MouseEvent) => void\n  onTouchStart: (event: TouchEvent) => void\n} {\n  return {\n    ...controlAriaProps(popupState),\n    onClick: popupState.open,\n    onTouchStart: popupState.open,\n  }\n}\n\n/**\n * Creates props for a component that opens the popup on its contextmenu event (right click).\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindContextMenu(popupState: PopupState): ControlAriaProps & {\n  onContextMenu: (event: MouseEvent) => void\n} {\n  return {\n    ...controlAriaProps(popupState),\n    onContextMenu: (e: MouseEvent) => {\n      e.preventDefault()\n      popupState.open(e)\n    },\n  }\n}\n\n/**\n * Creates props for a component that toggles the popup when clicked.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindToggle(popupState: PopupState): ControlAriaProps & {\n  onClick: (event: MouseEvent) => void\n  onTouchStart: (event: TouchEvent) => void\n} {\n  return {\n    ...controlAriaProps(popupState),\n    onClick: popupState.toggle,\n    onTouchStart: popupState.toggle,\n  }\n}\n\n/**\n * Creates props for a component that opens the popup while hovered.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindHover(popupState: PopupState): ControlAriaProps & {\n  onTouchStart: (event: TouchEvent) => any\n  onMouseOver: (event: MouseEvent) => any\n  onMouseLeave: (event: MouseEvent) => any\n} {\n  const { open, onMouseLeave } = popupState\n  return {\n    ...controlAriaProps(popupState),\n    onTouchStart: open,\n    onMouseOver: open,\n    onMouseLeave,\n  }\n}\n\n/**\n * Creates props for a component that opens the popup while focused.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindFocus(popupState: PopupState): ControlAriaProps & {\n  onFocus: (event: FocusEvent) => any\n  onBlur: (event: FocusEvent) => any\n} {\n  const { open, onBlur } = popupState\n  return {\n    ...controlAriaProps(popupState),\n    onFocus: open,\n    onBlur,\n  }\n}\n\n/**\n * Creates props for a component that opens the popup while double click.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindDoubleClick({\n  isOpen,\n  open,\n  popupId,\n  variant,\n}: PopupState): {\n  'aria-controls'?: string\n  'aria-describedby'?: string\n  'aria-haspopup'?: true\n  onDoubleClick: (event: MouseEvent) => any\n} {\n  return {\n    // $FlowFixMe\n    [variant === 'popover' ? 'aria-controls' : 'aria-describedby']: isOpen\n      ? popupId\n      : null,\n    'aria-haspopup': variant === 'popover' ? true : undefined,\n    onDoubleClick: open,\n  }\n}\n\n/**\n * Creates props for a `Popover` component.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindPopover({\n  isOpen,\n  anchorEl,\n  anchorPosition,\n  close,\n  popupId,\n  onMouseLeave,\n  disableAutoFocus,\n  _openEventType,\n}: PopupState): {\n  id?: string\n  anchorEl?: Element | null\n  anchorPosition?: PopoverPosition\n  anchorReference: PopoverReference\n  open: boolean\n  onClose: () => void\n  onMouseLeave: (event: MouseEvent) => void\n  disableAutoFocus?: boolean\n  disableEnforceFocus?: boolean\n  disableRestoreFocus?: boolean\n} {\n  const usePopoverPosition = _openEventType === 'contextmenu'\n  return {\n    id: popupId,\n    anchorEl,\n    anchorPosition,\n    anchorReference: usePopoverPosition ? 'anchorPosition' : 'anchorEl',\n    open: isOpen,\n    onClose: close,\n    onMouseLeave,\n    ...(disableAutoFocus && {\n      disableAutoFocus: true,\n      disableEnforceFocus: true,\n      disableRestoreFocus: true,\n    }),\n  }\n}\n\n/**\n * Creates props for a `Menu` component.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\n\n/**\n * Creates props for a `Popover` component.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindMenu({\n  isOpen,\n  anchorEl,\n  anchorPosition,\n  close,\n  popupId,\n  onMouseLeave,\n  disableAutoFocus,\n  _openEventType,\n}: PopupState): {\n  id?: string\n  anchorEl?: Element | null\n  anchorPosition?: PopoverPosition\n  anchorReference: PopoverReference\n  open: boolean\n  onClose: () => void\n  onMouseLeave: (event: MouseEvent) => void\n  autoFocus?: boolean\n  disableAutoFocusItem?: boolean\n  disableAutoFocus?: boolean\n  disableEnforceFocus?: boolean\n  disableRestoreFocus?: boolean\n} {\n  const usePopoverPosition = _openEventType === 'contextmenu'\n  return {\n    id: popupId,\n    anchorEl,\n    anchorPosition,\n    anchorReference: usePopoverPosition ? 'anchorPosition' : 'anchorEl',\n    open: isOpen,\n    onClose: close,\n    onMouseLeave,\n    ...(disableAutoFocus && {\n      autoFocus: false,\n      disableAutoFocusItem: true,\n      disableAutoFocus: true,\n      disableEnforceFocus: true,\n      disableRestoreFocus: true,\n    }),\n  }\n}\n/**\n * Creates props for a `Popper` component.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindPopper({\n  isOpen,\n  anchorEl,\n  popupId,\n  onMouseLeave,\n}: PopupState): {\n  id?: string\n  anchorEl?: Element | null\n  open: boolean\n  onMouseLeave: (event: MouseEvent) => void\n} {\n  return {\n    id: popupId,\n    anchorEl,\n    open: isOpen,\n    onMouseLeave,\n  }\n}\n\n/**\n * Creates props for a `Dialog` component.\n *\n * @param {object} popupState the argument passed to the child function of\n * `PopupState`\n */\nexport function bindDialog({ isOpen, close }: PopupState): {\n  open: boolean\n  onClose: (event: SyntheticEvent) => any\n} {\n  return {\n    open: isOpen,\n    onClose: close,\n  }\n}\n\nfunction getPopup(\n  element: Element,\n  { popupId }: PopupState\n): Element | null | undefined {\n  if (!popupId) return null\n  const rootNode: any =\n    typeof element.getRootNode === 'function' ? element.getRootNode() : document\n  if (typeof rootNode.getElementById === 'function') {\n    return rootNode.getElementById(popupId)\n  }\n  return null\n}\n\nfunction isElementInPopup(element: Element, popupState: PopupState): boolean {\n  const { anchorEl, _childPopupState } = popupState\n  return (\n    isAncestor(anchorEl, element) ||\n    isAncestor(getPopup(element, popupState), element) ||\n    (_childPopupState != null && isElementInPopup(element, _childPopupState))\n  )\n}\n\nfunction isAncestor(\n  parent: Element | null | undefined,\n  child: Element | null | undefined\n): boolean {\n  if (!parent) return false\n  while (child) {\n    if (child === parent) return true\n    child = child.parentElement\n  }\n  return false\n}\n"],"mappings":"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","ignoreList":[]}
