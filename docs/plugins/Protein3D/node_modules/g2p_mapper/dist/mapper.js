"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.genomeToTranscriptSeqMapping = genomeToTranscriptSeqMapping;
function genomeToTranscriptSeqMapping(feature) {
    var _a, _b;
    const strand = feature.strand;
    const refName = feature.refName;
    const cds = (_b = (_a = feature.subfeatures) === null || _a === void 0 ? void 0 : _a.filter(f => f.type === 'CDS').sort((a, b) => strand * (a.start - b.start))) !== null && _b !== void 0 ? _b : [];
    const g2p = {};
    const p2g = {};
    let proteinCounter = 0;
    if (strand !== -1) {
        for (const f of cds) {
            for (let genomePos = f.start; genomePos < f.end; genomePos++) {
                const proteinPos = Math.floor(proteinCounter++ / 3);
                g2p[genomePos] = proteinPos;
                if (!p2g[proteinPos]) {
                    p2g[proteinPos] = genomePos;
                }
            }
        }
    }
    else {
        for (const f of cds) {
            for (let genomePos = f.end; genomePos > f.start; genomePos--) {
                const proteinPos = Math.floor(proteinCounter++ / 3);
                g2p[genomePos] = proteinPos;
                if (!p2g[proteinPos]) {
                    p2g[proteinPos] = genomePos;
                }
            }
        }
    }
    return { g2p, p2g, refName, strand };
}
//# sourceMappingURL=mapper.js.map