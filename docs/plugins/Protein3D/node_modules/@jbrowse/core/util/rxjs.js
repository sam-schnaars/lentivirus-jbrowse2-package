"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ObservableCreate = ObservableCreate;
const rxjs_1 = require("rxjs");
const operators_1 = require("rxjs/operators");
const _1 = require(".");
/**
 * Wrapper for rxjs Observable.create with improved error handling and
 * aborting support
 * @param func - observer function, could be async
 */
function ObservableCreate(func, signal) {
    return new rxjs_1.Observable((observer) => {
        try {
            const ret = func(observer);
            if (ret === null || ret === void 0 ? void 0 : ret.catch) {
                ret.catch((error) => {
                    observer.error(error);
                });
            }
        }
        catch (error) {
            observer.error(error);
        }
    }).pipe((0, operators_1.takeUntil)((0, _1.observeAbortSignal)(signal)));
}
